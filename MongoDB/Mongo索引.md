#### 索引数据结构

B+ 树



#### 创建索引的限制

- 每个索引至少需要数据空间为8kb
- 索引名称长度不能超过128字段
- 复合索引不能超过32个属性（字段）
- 每个集合Collection不能超过64个索引



#### 后台索引操作

在密集(快达到数据库最大容量）Collection创建索引：

在默认情况下，在密集的Collection创建索引，会阻止其他操作。在给密集的Collection创建索引时， 索引构建完成之前，保存Collection的数据库不可用于读取或写入操作。 任何需要对所有数据库（例如listDatabases）进行读或写锁定的操作都将等待不是后台进程的索引构建完成。

可以使用background属性进行设置后台索引创建，操作如下：

```java
db.people.createIndex( { zipcode: 1 }, { background: true } )
```



#### 索引策略

* 应用程序的最佳索引必须考虑许多因素，包括期望查询的类型，读取与写入的比率以及系统上的可用内存量。
* 在开发索引策略时，您应该深入了解应用程序的查询。在构建索引之前，映射将要运行的查询类型，以便您可以构建引用这些字段的索引。索引具有性能成本，但是对于大型数据集上的频繁查询而言，它们的价值更高。考虑应用程序中每个查询的相对频率以及查询是否证明索引是合理的。
* 设计索引的最佳总体策略是使用与您将在生产中运行的数据集类似的数据集来分析各种索引配置，以查看哪些配置性能最佳。检查为集合创建的当前索引，以确保它们支持您当前和计划的查询。如果不再使用索引，请删除索引。
* 通常，MongoDB仅使用一个索引来完成大多数查询。但是，$或查询的每个子句可能使用不同的索引，从2.6开始，MongoDB可以使用多个索引的交集。

